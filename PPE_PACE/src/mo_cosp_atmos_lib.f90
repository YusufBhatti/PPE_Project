! $Revision: 23 $, $Date: 2011-03-31 15:41:37 +0200 (Do, 31. MÃ¤r 2011) $
! $URL: http://cfmip-obs-sim.googlecode.com/svn/stable/v1.4.0/quickbeam/atmos_lib.f90 $
! ATMOS_LIB: Atmospheric science procedures for F90
! Compiled/Modified:
!   07/01/06  John Haynes (haynes@atmos.colostate.edu)
!
! mcclatchey (subroutine)
  
  module mo_cosp_atmos_lib
  use mo_kind,		ONLY: wp
  implicit none
  
  contains
  
! ----------------------------------------------------------------------------
! subroutine MCCLATCHEY
! ----------------------------------------------------------------------------
  subroutine mcclatchey(stype,hgt,prs,tk,rh)
  implicit none
!
! Purpose:
!   returns a standard atmospheric profile
!
! Input:
!   [stype]   type of profile to return
!             1 = mid-latitude summer
!             2 = mid-latitude winter
!             3 = tropical
!
! Outputs:
!   [hgt]     height (m)
!   [prs]     pressure (hPa)
!   [tk]      temperature (K)
!   [rh]      relative humidity (%)
!
! Created:
!   06/01/2006  John Haynes (haynes@atmos.colostate.edu)

! ----- INPUTS -----
  integer, intent(in) :: &
  stype

  integer, parameter :: ndat = 33

! ----- OUTPUTS -----
  real(wp), intent(out), dimension(ndat) :: &
  hgt, &                        ! height (m)
  prs, &                        ! pressure (hPa)
  tk, &                         ! temperature (K)
  rh                            ! relative humidity (%)
  
  hgt = (/0.00000_wp, 1000.00_wp, 2000.00_wp, 3000.00_wp, 4000.00_wp, 5000.00_wp, &
          6000.00_wp, 7000.00_wp, 8000.00_wp, 9000.00_wp, 10000.0_wp, 11000.0_wp, &
          12000.0_wp, 13000.0_wp, 14000.0_wp, 15000.0_wp, 16000.0_wp, 17000.0_wp, &
          18000.0_wp, 19000.0_wp, 20000.0_wp, 21000.0_wp, 22000.0_wp, 23000.0_wp, &
          24000.0_wp, 25000.0_wp, 30000.0_wp, 35000.0_wp, 40000.0_wp, 45000.0_wp, &
          50000.0_wp, 70000.0_wp, 100000._wp/)

  select case(stype)

  case(1)
!   // mid-latitide summer  
    prs = (/1013.00_wp, 902.000_wp, 802.000_wp, 710.000_wp, 628.000_wp, 554.000_wp, &
            487.000_wp, 426.000_wp, 372.000_wp, 324.000_wp, 281.000_wp, 243.000_wp, &
            209.000_wp, 179.000_wp, 153.000_wp, 130.000_wp, 111.000_wp, 95.0000_wp, &
            81.2000_wp, 69.5000_wp, 59.5000_wp, 51.0000_wp, 43.7000_wp, 37.6000_wp, &
            32.2000_wp, 27.7000_wp, 13.2000_wp, 6.52000_wp, 3.33000_wp, 1.76000_wp, &
            0.951000_wp,0.0671000_wp,0.000300000_wp/)
	   
    tk =  (/294.000_wp, 290.000_wp, 285.000_wp, 279.000_wp, 273.000_wp, 267.000_wp, &
            261.000_wp, 255.000_wp, 248.000_wp, 242.000_wp, 235.000_wp, 229.000_wp, &
            222.000_wp, 216.000_wp, 216.000_wp, 216.000_wp, 216.000_wp, 216.000_wp, &
            216.000_wp, 217.000_wp, 218.000_wp, 219.000_wp, 220.000_wp, 222.000_wp, &
            223.000_wp, 224.000_wp, 234.000_wp, 245.000_wp, 258.000_wp, 270.000_wp, &
            276.000_wp, 218.000_wp, 210.000_wp/)

    rh =  (/74.8384_wp, 63.4602_wp, 55.0485_wp, 45.4953_wp, 39.3805_wp, 31.7965_wp, &
            30.3958_wp, 29.5966_wp, 30.1626_wp, 29.3624_wp, 30.3334_wp, 19.0768_wp, &
            11.0450_wp, 6.61278_wp, 3.67379_wp, 2.79209_wp, 2.35123_wp, 2.05732_wp, &
            1.83690_wp, 1.59930_wp, 1.30655_wp, 1.31890_wp, 1.17620_wp,0.994076_wp, &
            0.988566_wp,0.989143_wp,0.188288_wp,0.0205613_wp,0.00271164_wp,0.000488798_wp, &
            0.000107066_wp,0.000406489_wp,0.00000768645_wp/)

  case(2)
!   // mid-latitude winter
    prs = (/1018.00_wp, 897.300_wp, 789.700_wp, 693.800_wp, 608.100_wp, 531.300_wp, &
            462.700_wp, 401.600_wp, 347.300_wp, 299.200_wp, 256.800_wp, 219.900_wp, &
            188.200_wp, 161.000_wp, 137.800_wp, 117.800_wp, 100.700_wp, 86.1000_wp, &
            73.5000_wp, 62.8000_wp, 53.7000_wp, 45.8000_wp, 39.1000_wp, 33.4000_wp, &
            28.6000_wp, 24.3000_wp, 11.1000_wp, 5.18000_wp, 2.53000_wp, 1.29000_wp, &
            0.682000_wp,0.0467000_wp,0.000300000_wp/)

    tk =  (/272.200_wp, 268.700_wp, 265.200_wp, 261.700_wp, 255.700_wp, 249.700_wp, &
            243.700_wp, 237.700_wp, 231.700_wp, 225.700_wp, 219.700_wp, 219.200_wp, &
            218.700_wp, 218.200_wp, 217.700_wp, 217.200_wp, 216.700_wp, 216.200_wp, &
            215.700_wp, 215.200_wp, 215.200_wp, 215.200_wp, 215.200_wp, 215.200_wp, &
            215.200_wp, 215.200_wp, 217.400_wp, 227.800_wp, 243.200_wp, 258.500_wp, &
            265.700_wp, 230.700_wp, 210.200_wp/)

    rh =  (/76.6175_wp, 70.1686_wp, 65.2478_wp, 56.6267_wp, 49.8755_wp, 47.1765_wp, &
            44.0477_wp, 31.0565_wp, 23.0244_wp, 19.6510_wp, 17.8987_wp, 17.4376_wp, &
            16.0621_wp, 5.10608_wp, 3.00679_wp, 2.42293_wp, 2.16406_wp, 2.00901_wp, &
            1.90374_wp, 1.98072_wp, 1.81902_wp, 2.06155_wp, 2.06154_wp, 2.18280_wp, &
            2.42531_wp, 2.70824_wp,1.12105_wp,0.108119_wp,0.00944200_wp,0.00115201_wp, &
            0.000221094_wp,0.000101946_wp,0.00000749350_wp/)

  case(3)
!   // tropical
    prs = (/1013.00_wp, 904.000_wp, 805.000_wp, 715.000_wp, 633.000_wp, 559.000_wp, &
            492.000_wp, 432.000_wp, 378.000_wp, 329.000_wp, 286.000_wp, 247.000_wp, &
            213.000_wp, 182.000_wp, 156.000_wp, 132.000_wp, 111.000_wp, 93.7000_wp, &
            78.9000_wp, 66.6000_wp, 56.5000_wp, 48.0000_wp, 40.9000_wp, 35.0000_wp, &
            30.0000_wp, 25.7000_wp, 12.2000_wp, 6.00000_wp, 3.05000_wp, 1.59000_wp, &
            0.854000_wp,0.0579000_wp,0.000300000_wp/)

    tk =  (/300.000_wp, 294.000_wp, 288.000_wp, 284.000_wp, 277.000_wp, 270.000_wp, &
            264.000_wp, 257.000_wp, 250.000_wp, 244.000_wp, 237.000_wp, 230.000_wp, &
            224.000_wp, 217.000_wp, 210.000_wp, 204.000_wp, 197.000_wp, 195.000_wp, &
            199.000_wp, 203.000_wp, 207.000_wp, 211.000_wp, 215.000_wp, 217.000_wp, &
            219.000_wp, 221.000_wp, 232.000_wp, 243.000_wp, 254.000_wp, 265.000_wp, &
            270.000_wp, 219.000_wp, 210.000_wp/)

    rh =  (/71.4334_wp, 69.4097_wp, 71.4488_wp, 46.7724_wp, 34.7129_wp, 38.3820_wp, &
            33.7214_wp, 32.0122_wp, 30.2607_wp, 24.5059_wp, 19.5321_wp, 13.2966_wp, &
            8.85795_wp, 5.87496_wp, 7.68644_wp, 12.8879_wp, 29.4976_wp, 34.9351_wp, &
            17.1606_wp, 9.53422_wp, 5.10154_wp, 3.45407_wp, 2.11168_wp, 1.76247_wp, &
            1.55162_wp, 1.37966_wp,0.229799_wp,0.0245943_wp,0.00373686_wp,0.000702138_wp, &
            0.000162076_wp,0.000362055_wp,0.00000768645_wp/)
	    
  case default
    print *, 'Must enter a profile type'
    stop
    
  end select
  
  end subroutine mcclatchey
  
  end module mo_cosp_atmos_lib
